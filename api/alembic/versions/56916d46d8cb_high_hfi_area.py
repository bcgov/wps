"""high_hfi_area

Revision ID: 56916d46d8cb
Revises: 7d240064d71a
Create Date: 2022-12-08 15:28:34.992996

"""
from alembic import op
import sqlalchemy as sa
from sqlalchemy.dialects import postgresql
from wps_shared.db.models.common import TZTimeStamp

# revision identifiers, used by Alembic.
revision = '56916d46d8cb'
down_revision = '7d240064d71a'
branch_labels = None
depends_on = None


def upgrade():
    # ### commands auto generated by Alembic ###
    op.create_table(
        "run_parameters",
        sa.Column("id", sa.Integer(), nullable=False),
        sa.Column(
            "run_type",
            postgresql.ENUM("actual", "forecast", create_type=False, name="runtypeenum"),
            nullable=False,
        ),
        sa.Column("run_datetime", TZTimeStamp(), nullable=False),
        sa.Column("for_date", sa.Date(), nullable=False),
        sa.PrimaryKeyConstraint("id"),
        sa.UniqueConstraint("run_type", "run_datetime", "for_date"),
        comment="A combination of run type, run datetime and for date.",
    )
    op.create_index(op.f('ix_run_parameters_id'), 'run_parameters', ['id'], unique=False)
    op.create_index(op.f('ix_run_parameters_for_date'), 'run_parameters', ['for_date'], unique=False)
    op.create_index(op.f('ix_run_parameters_run_datetime'), 'run_parameters', ['run_datetime'], unique=False)
    op.create_index(op.f('ix_run_parameters_run_type'), 'run_parameters', ['run_type'], unique=False)
    op.create_table('high_hfi_area',
                    sa.Column('id', sa.Integer(), nullable=False),
                    sa.Column('advisory_shape_id', sa.Integer(), nullable=False),
                    sa.Column('run_parameters', sa.Integer(), nullable=False),
                    sa.Column('advisory_area', sa.Float(), nullable=False),
                    sa.Column('warn_area', sa.Float(), nullable=False),
                    sa.ForeignKeyConstraint(['advisory_shape_id'], ['advisory_shapes.id'], ),
                    sa.ForeignKeyConstraint(['run_parameters'], ['run_parameters.id'], ),
                    sa.PrimaryKeyConstraint('id'),
                    comment='Area under advisory/warning per fire zone. advisory_area refers to the total area in a fire zone with HFI values between 4000 - 10000 and warn_area refers to the total area in a fire zone with HFI values exceeding 10000.'
                    )
    op.create_index(op.f('ix_high_hfi_area_id'), 'high_hfi_area', ['id'], unique=False)
    op.create_index(op.f('ix_high_hfi_area_run_parameters'), 'high_hfi_area', ['run_parameters'], unique=False)
    # ### end Alembic commands ###


def downgrade():
    # ### commands auto generated by Alembic ###
    op.drop_index(op.f('ix_high_hfi_area_id'), table_name='high_hfi_area')
    op.drop_table('high_hfi_area')
    op.drop_index(op.f('ix_run_parameters_id'), table_name='run_parameters')
    op.drop_table('run_parameters')
    # ### end Alembic commands ###
