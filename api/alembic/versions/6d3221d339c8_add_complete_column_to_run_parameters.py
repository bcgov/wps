"""add complete column to run_parameters

Revision ID: 6d3221d339c8
Revises: 9298059a1912
Create Date: 2025-08-01 15:45:26.831707

"""

from alembic import op
import sqlalchemy as sa

# revision identifiers, used by Alembic.
revision = "6d3221d339c8"
down_revision = "9298059a1912"
branch_labels = None
depends_on = None


def upgrade():
    # ### commands auto generated by Alembic ###
    op.add_column(
        "run_parameters", sa.Column("complete", sa.Boolean(), nullable=True, default=False)
    )

    # step 2: update all existing rows to have complete = True
    op.execute("UPDATE run_parameters SET complete = true WHERE complete IS NULL")

    # step 3: alter the column to be non-nullable
    op.alter_column("run_parameters", "complete", nullable=False)

    # ### end Alembic commands ###


def downgrade():
    # ### commands auto generated by Alembic ###
    op.drop_column("run_parameters", "complete")
    # ### end Alembic commands ###
